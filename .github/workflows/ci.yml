name: CI

on:
  push:
    branches: [ main, ci-add-rls-tests ]
  pull_request:
    branches: [ main ]

jobs:
  lint-and-check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install SQLFluff for SQL linting
        run: |
          pip install sqlfluff

      - name: Lint test RLS SQL file
        run: |
          sqlfluff lint scripts/test_rls.sql --dialect postgres

      - name: Check for formatting issues
        run: |
          echo "ðŸ§ª Arquivo scripts/test_rls.sql validado com sucesso"
